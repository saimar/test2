"use strict";!function(n,e){"undefined"!=typeof module&&module.exports?(e("undefined"==typeof angular?require("angular"):angular),module.exports="ActivityMonitor"):"function"==typeof define&&define.amd?define(["angular"],e):e(n.angular)}(this,function(n){function e(n){function e(){p.options.enabled=!1,clearInterval(g.inactivity),clearInterval(g.keepAlive),n.off(m,c)}function i(){n.on(m,c),p.options.enabled=!0,p.user.warning=!1,g.keepAlive=setInterval(function(){s(o)},p.options.keepAlive*t),g.inactivity=setInterval(function(){var n=Date.now(),i=n-(p.options.inactive-p.options.warning)*t,o=n-p.options.inactive*t;!p.user.warning&&p.user.action<=i&&(p.user.warning=!0,s(r)),p.user.active&&p.user.action<=o&&(p.user.active=!1,s(a),e())},p.options.monitor*t)}function c(){p.user.active=!0,p.user.action=Date.now(),s(u),p.user.warning&&(p.user.warning=!1,s(o))}function s(n){if(p.options.enabled){var e=Object.keys(d[n]);n&&e.length&&e.forEach(function(e){d[n][e]&&d[n][e]()})}}function l(n,e){n&&"function"==typeof e&&(n=f(n,e),d[n.name][n.space]=e,!p.options.enabled&&i())}function v(n,e){return n=f(n,e),n.space?void(d[n.name][n.space]=null):void(d[n.name]={})}function f(n,e){return n=n.split("."),n[1]||"function"!=typeof e||(n[1]=e.toString().substr(0,150).replace(/\r?\n|\r|\s+/gm,"")),{name:n[0],space:n[1]}}var p=this;p.options={enabled:!1,keepAlive:800,inactive:900,warning:60,monitor:3},p.user={action:Date.now(),active:!0,warning:!1},p.activity=c,p.on=p.bind=l,p.off=p.unbind=v;var d={};d[o]={},d[a]={},d[r]={},d[u]={};var g={inactivity:null,keepAlive:null},m=["mousemove","mousedown","keypress","wheel","touchstart","scroll"].join(" ");return p}var i=n.module("ActivityMonitor",[]).service("ActivityMonitor",e),t=1e3,o="keepAlive",a="inactive",r="warning",u="activity";return e.$inject=["$document"],i});